<!DOCTYPE HTML>

<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!--Title that appears on window bar-->
    <Title>Folder Paint</Title>

    <!--LINKS-->
    <!--Linking front end stylesheet-->
    <link rel="stylesheet" href="./Main_Panel.css">
    <!--Linking backend Javascript-->
    <script src= "Linker.js"> </script>
</head>


<!--DRAGGABLE REGIONS-->
<!--Setting the entire body as draggable-->
<body style="-webkit-app-region: drag">

  <!--Setting on top of the title as draggable-->
  <div class = "Translucent_Title" style="-webkit-app-region: drag">Folder Painter</div>


  <!--Path bar input field-->
  <input type="text" id="Path_Bar" placeholder="Paste Folder Path Here" spellcheck="false" oninput="Processed()"/>

  <!--MAIN LEFT PANEL-->
  <div id= "Left_Panel">
    Color Picker

    <!--Favourite button-->
    <label class = "Favourite_Button_Container">
      <input type = "checkbox" onchange = "Add_Favourite(this)" id = "Star_Button"/>
      &#9733;
    </label>

    <!--Hue slider-->
    <div class= "Hue_Slider_Container">
      <input id = "Hue_Slider_Object" class="Hue_Slider" type="range" min="-180" max="180"
       value="0" oninput="Wash_Paint_Animation();Paint_Filling();" onchange="Processed();Reset_Favourite();">
      <div id="Hue_Label">H</div>
    </div>

    <!--Saturation slider-->
    <div class= "Saturation_Slider_Container">
      <input id = "Saturation_Slider_Object" class="Saturation_Slider" type="range"
      min="-100" max="100" value="0" oninput="Wash_Paint_Animation();Paint_Filling();"
      onchange="Processed();Reset_Favourite();">
      <div id="Saturation_Label">S</div>
    </div>

    <!--Colour palette sub-panel-->
    <div class = "Colour_Palette">
      <button type="submit" id="Colour_1" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_2" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_3" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_4" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <br>
      <button type="submit" id="Colour_5" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_6" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_7" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_8" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>
      <button type="submit" id="Colour_9" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"></button>

      <div class = "Reset_Button_Section">
      <button type="submit" id="Colour_0" onclick="Colour_Palette_Pressed(this.id);Fade_Out();Reset_Favourite();"><span>&#8634;</span></button>
      </div>

    </div>

    <!--Common colour palette script-->
    <script type="text/javascript">
      function Colour_Palette_Pressed(Colour_ID){
      var Colour_Palette_Lookup_Table = [
        [0, 0], //Reset to original -> format: [Hue, Satruation]
        [89, 13], //Colour selection 1 -> format: [Hue, Saturation]
        [109, 49], //Colour selection 2 -> format: [Hue, Saturation]
        [132, 35], //Colour selection 3 -> format: [Hue, Saturation]
        [-103, 40], //Colour selection 4 -> format: [Hue, Saturation]
        [180, 45], //Colour selection 5 -> format: [Hue, Saturation]
        [-28, 40], //Colour selection 6 -> format: [Hue, Saturation]
        [-10, 40], //Colour selection 7 -> format: [Hue, Saturation]
        [53, 26], //Colour selection 8 -> format: [Hue, Saturation]
        [29, 40]  //Colout selection 9 -> format: [Hue, Saturation]
        ];
        Wash_Paint_Animation();
        Paint_Filling();
        var Popped_Field = parseInt(Colour_ID.split('_').pop());
        Hue_Value = Colour_Palette_Lookup_Table[Popped_Field][0];
        Saturation_Value = Colour_Palette_Lookup_Table[Popped_Field][1];

      Fade_Out();

      document.getElementById("Hue_Slider_Object").value = Hue_Value;
      document.getElementById("Saturation_Slider_Object").value = Saturation_Value;
      Fade_In();

      }
    </script>

    <!--Button to tab into favourites panel-->
    <label class = "Favourites_Tab_Bottom_Button" id = "Favourites_Tab_Bottom_Button">
      <input type = "checkbox" onchange = "Reveal_Favourites(this);" id = "Favourites_Tab"/>
      &#65086;
    </label>


  </div>


  <!--MAIN RIGHT PANEL-->
  <div id = "Right_Panel">

    <!--Right panel label-->
    <div class = "Right_Label">
      Preview
    </div>

    <!--Folder preview image-->
    <div class = "Preview_Image_Division">
      <img id = "Preview_Image" src="Folder_Icon.png" onerror="this.src='Folder_Icon.png'"/>
    </div>


    <!--Paint folder button-->
    <button id = "Select_Button" class = "Select_Button" onclick="Painting_Folder();Paint_Animation();">
      Paint
    </button>

    <!--FAVOURITES CARD-->
    <div id = "Favourites_Card_Panel">
      <button id = "Favourite_1" onclick = "Grab_Value(1);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_2" onclick = "Grab_Value(2);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_3" onclick = "Grab_Value(3);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_4" onclick = "Grab_Value(4);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_5" onclick = "Grab_Value(5);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_6" onclick = "Grab_Value(6);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_7" onclick = "Grab_Value(7);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_8" onclick = "Grab_Value(8);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_9" onclick = "Grab_Value(9);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
      <button id = "Favourite_10" onclick = "Grab_Value(10);Reset_Favourite();Wash_Paint_Animation();Paint_Filling();"></button>
    </div>

  </div>


  <!--JAVASCRIPT FRONT END FUNCTIONS-->
  <!--Left panel filling animation: function: Paint_Filling()-->
  <script>
      function Paint_Filling(){
      document.getElementById("Left_Panel").style.backgroundSize = "100% 100%";}
  </script>

  <!--Right panel wash away animation: function: Wash_Paint_Animation()-->
  <script type="text/javascript">
    function Wash_Paint_Animation(){
    // document.getElementById("Preview_Image").style.filter = "blur(20px)"
    //Blurring right panel and washing away
    // document.getElementById("Right_Panel").style.filter = "blur(20px)";
    document.getElementById("Right_Panel").style.backgroundSize = "100% 0%";
    //Displaying "Paint" on main select button
    document.getElementById("Select_Button").innerHTML = "Paint";
    document.getElementById("Select_Button").style.display = "inline-block";
    }
  </script>

  <!--Updates panels when sliders are released: function: Processed()-->
  <script type="text/javascript">
    function Processed(){
    //End blur on the right panel
    // setTimeout(function(){document.getElementById("Preview_Image").style.filter = "blur(0px)";}, 200);

    //INITIAL STATES UNTIL READY SLIDERS AND PATH ARE SELECTED
    //Washing away the paint on the right panel
    document.getElementById("Right_Panel").style.backgroundSize = "100% 0%";
    //Hiding the paint button until ready
    document.getElementById("Select_Button").style.visibility = "hidden";
    //Washing away paint on the path bar
    Path_Bar_Element = document.getElementById("Path_Bar").style;
    Path_Bar_Element.backgroundSize = "0% 100%";
    Path_Bar_Element.color = '#0dbad9';

    //Grabbing the path from the path field
    var Folder_Path_Name = document.getElementById("Path_Bar").value;

    //Checking if the path exists
    if(fs.existsSync(Folder_Path_Name)){
      console.log("Path Exists");

      //Popping of the last field in the path
      var Path_Target = Folder_Path_Name.split('/').pop();
      console.log(["Popped",Path_Target]);

      //Dictionary of false fields
      var False_Field = [
      "",
      "Desktop",
      "Documents",
      "Downloads",
      "Users"
      ];

      //Evaluating for any faulty terms that cannot be a folder
      var Number_Of_Faults = parseInt(0);
      for(Scanner = 0; Scanner < False_Field.length; Scanner++){
        if(String(Path_Target) == String(False_Field[Scanner])){
        Number_Of_Faults = Number_Of_Faults + 1;
        }
      }

    console.log(Number_Of_Faults);

      if (Number_Of_Faults == 0){
      //Checking for if the path name has a . and cannot be a folder
        if ((Path_Target.indexOf('.')) == -1){
          //Display the paint button and ready
          document.getElementById("Select_Button").innerHTML = "Paint";
          setTimeout(function() {document.getElementById("Select_Button").style.visibility = "visible";}, 200);
          //Paint the left panel
          document.getElementById("Left_Panel").style.backgroundSize = "100% 100%";
          //Paint the path bar background and set the path text to white
          document.getElementById("Path_Bar").style.color = "rgba(252,252,252,1)";
          document.getElementById("Path_Bar").style.backgroundSize = "100% 100%";
        }
      }
    }
    }
  </script>

  <!--Painting folder re-route function to backend: function: Painting_Folder()-->
  <script type="text/javascript">
    function Painting_Folder(){
    Paint_Button_Clicked();
    }
  </script>

  <!--Painting animation: function: Paint_Animation()-->
  <script>
    function Paint_Animation(){
    //Painting the right panel
    document.getElementById("Right_Panel").style.backgroundSize = "100% 100%";
    //Washing away the left panel
    document.getElementById("Left_Panel").style.backgroundSize = "100% 0%";
    }
  </script>

  <!--Fade out slider thumb animation-->
  <script type="text/javascript">
      function Fade_Out(){
      const Slider_1 = document.getElementById('Hue_Slider_Object');
      const Slider_2 = document.getElementById('Saturation_Slider_Object');

      Slider_1.classList.remove('Fade_Out_Animation'); // reset animation
      Slider_2.classList.remove('Fade_Out_Animation'); // reset animation

      void Slider_1.offsetWidth; // trigger reflow
      void Slider_2.offsetWidth; // trigger reflow
      Slider_1.classList.add('Fade_Out_Animation'); // start animation
      Slider_2.classList.add('Fade_Out_Animation'); // start animation
      }
  </script>

  <!--Fade in slider thumb animation-->
  <script type="text/javascript">
      function Fade_In(){
      const Slider_1 = document.getElementById('Hue_Slider_Object');
      const Slider_2 = document.getElementById('Saturation_Slider_Object');

      Slider_1.classList.remove('Fade_In_Animation'); // reset animation
      Slider_2.classList.remove('Fade_In_Animation'); // reset animation

      void Slider_1.offsetWidth; // trigger reflow
      void Slider_2.offsetWidth; // trigger reflow
      Slider_1.classList.add('Fade_In_Animation'); // start animation
      Slider_2.classList.add('Fade_In_Animation'); // start animation
      }
  </script>


  <script type="text/javascript">
    function Reset_Favourite(){

      // Grabbing the value of the hue slider
      var Hue_Slider_Value = document.getElementById("Hue_Slider_Object").value;
      // Parsing the value of the hue slider as an integer
      Hue_Slider_Value = parseInt(Hue_Slider_Value);

      // Grabbing the value of the saturation slider
      var Saturation_Slider_Value = document.getElementById("Saturation_Slider_Object").value;
      // Parsing the value of the saturation slider as an integer
      Saturation_Slider_Value = parseInt(Saturation_Slider_Value);


    // Grabbing the data from the JSON file
    var Favourite_Colours_Data_Stream_Check = fs.readFileSync('Favourites.json');
    var Favourite_Colours = JSON.parse(Favourite_Colours_Data_Stream_Check);

    var Currently_In_Database = 0;

    // Retrieving the current arrays from the JSON object
      var Retrieved_Hue_Array = Favourite_Colours.Hue;
      var Retrieved_Saturation_Array = Favourite_Colours.Saturation;
      var Retrieved_Path_Array = Favourite_Colours.Path;

    // Checking the database for the current slider value
    // Scanning the arrays for the current slider values to remove
    var Number_Of_Favourites = parseInt(Retrieved_Hue_Array.length);

    for(Key_Scanner = 0; Key_Scanner < Number_Of_Favourites; Key_Scanner++){
    Hue_Key_Value = parseInt(Retrieved_Hue_Array[Key_Scanner]);
    Saturation_Key_Value = parseInt(Retrieved_Saturation_Array[Key_Scanner]);

    console.log("Hue: " + String(Hue_Key_Value) + " Saturation: " + String(Saturation_Key_Value));

    if((Hue_Key_Value == Hue_Slider_Value)&&(Saturation_Key_Value == Saturation_Slider_Value)){
      Currently_In_Database = 1;
    }
    }

    var Star = document.getElementById("Star_Button").parentNode.classList.add("checked");
    Favourite_State = 1;


    if (Currently_In_Database == 0){
      var Star = document.getElementById("Star_Button").parentNode.classList.remove("checked");
      Favourite_State = 0;
    }
    }
  </script>




</body>


</html>
